<grid>:

	search_sir_head: search_sir_head
    search_rule: search_rule
    technique_spinner: technique_spinner
    search_in_description: search_in_description
    xml_file_path: xml_file_path

    GridLayout:
		cols:1
		size: root.width - 200, root.height - 140
        pos: 50, 150

        GridLayout:
            cols: 2

            Label:
                text: "[color=ff000] \n\n\n Search by SIR head name: [/color]"
                markup: True
            TextInput:
                id: search_sir_head
                multiline: True
                size_hint: (0.7, None)
                height: 35

            Label:
                text: "[color=ff000] \n\n\n\n Search by rule name: [/color]"
                markup: True
            TextInput:
                id: search_rule
                multiline: False
                size_hint: (0.7, None)
                height: 35

            Label:
                text: "[color=ff000] \n\n\n\n Search by keywords in description: [/color]"
                markup: True
            TextInput:
                id: search_in_description
                multiline:True
                size_hint: (0.7, None)
                height: 35

            Label:
                id: technique
                text: "[color=ff000] \n\n\n Search by technique name: [/color]"
                markup: True
            Spinner:
                id: technique_spinner
                text: "technique"
                values: ['', 'Derived Environment Rule', 'Fact', 'T1078 - Valid Accounts', 'Exploitation for Client Execution (DT)', 'T1068 - Exploitation for Privilege Escalation (NB)', 'Exploitation for Privilege Escalation (DT)', 'T1190 - Exploit Public-Facing Application (NB)', 'Abuse Elevation Control Mechanism (DT)', 'T1078 - Valid Accounts (NB)', 'T1203 - Exploitation for Client Execution (NB)', 'T1204 - User Execution (NB)', 'T1566 - Phishing (NB)', 'T1005 - Data from Local System (NB)', 'T1003 - OS Credential Dumping (NB)', 'Data from Local System (DT)', 'Building Block (NB)', 'Data from Network Shared Drive (DT)', 'Data from Network Shared Drive', 'Exploitation for Credential Access (DT)', 'T1003- OS Credential Dumping (NB)', 'T1558 - Steal or Forge Kerberos Tickets (NB)', 'TA1078 - Valid Account (NB)', 'Building Block', 'Man-in-the-Middle', 'Endpoint Denial of Service', 'Network Denial of Service', 'Password Policy Discovery', 'Network Sniffing (NB)', 'Network Sniffing', 'T1129 - Shared Modules (NB)', 'T1203 - Exploitation for Client Execution', 'T1204 - User Execution', 'Exploitation for Privilege Escalation', 'T1021 - Remote Services (NB)', 'T1563 - Remote Service Sessions Hijacking (NB)', 'Building Block (DT)', 'T1569 - System Services (NB)', 'T1055 - Process injection', 'T1565 - Data Manipulation', 'External Remote Services (NB)', 'Drive-by Compromise (NB)', 'Remote Service (NB)', 'Steal Application Access Token (NB)', 'Steal or Forge Kerberos Tickets (NB)', 'Command and Scripting Interpreter', 'Exploitation of Remote Services?', 'Remote Services? (DT)', 'Process Injection? (NB)', 'Exfiltration Over Alternative Protocol', 'OS Credential Dumping (NB)', 'Data Manipulation', 'Exploitation for Client Execution', 'Valid Accounts', 'User Execution (NB)', 'Exploit Public-Facing Application (NB)', 'Valid Accounts (DT)', 'Exploitation for Client Execution (NB)', 'Data from Local System', 'Credentials from Password Stores', 'Credentials from Password Stores (DT)', "(Specific to 3d printing, doesn't exist in MITRE yet)", 'Exfiltration Over Other Network Medium', 'File and Directory Discovery (DT)', 'Exfiltration Over Physical Medium', 'Derived Environment Rule (NB)', 'Fact & Derived Environment Rule', 'Disk Wipe']
                size_hint: (0.7, None)
                height: 35

        GridLayout:
            cols: 3
            padding: 5, 80, 0, 0
            spacing: 10

            Button:
                text: "Show results"
                on_press: root.perform_results()
                background_color: 0.3, 0.4, 0.5, 0.7
                size_hint: (0.8, None)
                height: 35

            Button:
                text: "export pddl"
                on_press: root.create_pddl()
                background_color: 0.3, 0.4, 0.5, 0.7
                size_hint: (0.5, None)
                height: 35

            Button:
                text: "export XML"
                on_press: root.create_XML()
                background_color: 0.3, 0.4, 0.5, 0.7
                size_hint: (0.5, None)
                height: 35

            TextInput:
                id: xml_file_path
                multiline:True
                size_hint: (0.1, None)
                height: 35

            Button:
                text: "import file"
                on_press: root.read_from_file()
                background_color: 0.3, 0.4, 0.5, 0.7
                size_hint: (0.5, None)
                height: 35

<Popups>:

    BoxLayout:
        pos: 0, 0
        RecycleView:
            viewclass: 'Label'
            data: root.res_data
            RecycleGridLayout:
                cols: 3
                size_hint: 1, None
                default_size: None, dp(300)
                default_size_hint: 1, None
                size_hint_y: None
                height: self.minimum_height
                width: self.minimum_width
                halign: 'center'
                valign: 'middle'
