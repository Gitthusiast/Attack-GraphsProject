Index: DataPreperation.py
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>import pandas as pd\r\nimport re\r\nfrom nltk.corpus import stopwords\r\n\r\nINTERACTION_RULES = {}\r\nKEYWORDS_DICT = {}\r\nTECHNIQUE_DICT = {}\r\n\r\n\r\ndef create_ir_dict(dfMulVAl):\r\n    \"\"\"\r\n    This function creates a dictionary which keys are tuples of (row_number, interaction_rule_head)\r\n     and values are lists of ir bodies\r\n    :param path: data frame of the given xlsx file\r\n    \"\"\"\r\n\r\n    for row, IR in enumerate(dfMulVAl['Interaction Rules']):\r\n\r\n        if isinstance(IR, str):\r\n\r\n            splited_ir = IR.split(\":-\")\r\n\r\n            if len(splited_ir[0].split('\\n')) >= 2 and splited_ir[0].split('\\n')[0][0] == '%':\r\n\r\n                ir_head = splited_ir[0].split('\\n')[1]\r\n            else:\r\n                if splited_ir[0][-1] == ' ':\r\n                    ir_head = splited_ir[0][:-1]\r\n                else:\r\n                    ir_head = splited_ir[0]\r\n\r\n            if len(splited_ir) >= 2:  # check body\r\n\r\n                ir_body = re.split('\\n', splited_ir[1])\r\n                predicates = []\r\n                for predicate in ir_body:\r\n\r\n                    if len(predicate) >= 3 and predicate[1] != '%' and predicate[2] != '%':\r\n                        if predicate[-1] == \",\" or predicate[-1] == '.':\r\n                            predicate = predicate[:-1]\r\n                        predicates.append(predicate.strip())\r\n                INTERACTION_RULES.update({(row, ir_head): predicates})\r\n            else:\r\n                INTERACTION_RULES.update({(row, ir_head): None})\r\n        else:\r\n            INTERACTION_RULES.update({(row, dfMulVAl['Predicate'][row]): None})\r\n\r\n\r\ndef create_explanation_keyword_dict(dfMulVAl):\r\n    \"\"\"\r\n    This function creates the KEYWORDS_DICT which keys are keywords and values are row numbers\r\n    :param dfMulVAl: data frame of the given xlsx file\r\n    \"\"\"\r\n\r\n    english_stopwords = frozenset(stopwords.words('english'))\r\n\r\n    for row, explanation in enumerate(dfMulVAl['Explanation']):\r\n\r\n        if isinstance(explanation, str):\r\n\r\n            keywords = re.split(\"\\n| |\\.|,|\\(|\\)|\\\"|-|:|”|“|’\", explanation)\r\n            for keyword in keywords:\r\n                if keyword.lower() not in english_stopwords and len(keyword) > 1:\r\n                    if keyword.lower() not in KEYWORDS_DICT.keys():\r\n                        KEYWORDS_DICT.update({keyword.lower(): [row]})\r\n                    else:\r\n                        if row not in KEYWORDS_DICT[keyword.lower()]:\r\n                            KEYWORDS_DICT[keyword.lower()].append(row)\r\n\r\n\r\ndef create_MITRE_technique_dict(dfMulVAl):\r\n\r\n    \"\"\"\r\n    This function creates the TECHNIQUE_DICT which keys are techniques and values are row numbers\r\n    :param dfMulVAl: data frame of the given xlsx file\r\n    \"\"\"\r\n\r\n    for row, explanation in enumerate(dfMulVAl['MITRE Enterprise Technique']):\r\n\r\n        if isinstance(explanation, str):\r\n\r\n            techniques = re.split(\"\\n\", explanation)\r\n            for technique in techniques:\r\n                if technique == '':\r\n                    continue\r\n                technique = technique.strip()\r\n                if technique not in TECHNIQUE_DICT.keys():\r\n                    TECHNIQUE_DICT.update({technique: [row]})\r\n                else:\r\n                    if row not in TECHNIQUE_DICT[technique]:\r\n                        TECHNIQUE_DICT[technique].append(row)\r\n\r\n\r\npath = 'C:\\\\Users\\\\ADMIN\\\\Documents\\\\AttackGraphs\\\\Attack-GraphsProject\\\\MulVAL to MITRE-for IR Manager.xlsx'\r\ndfMulVAl = pd.read_excel(path)\r\n# create_ir_dict(dfMulVAl)\r\n# create_explanation_keyword_dict(dfMulVAl)\r\ncreate_MITRE_technique_dict(dfMulVAl)\r\nprint(TECHNIQUE_DICT.keys())\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/DataPreperation.py b/DataPreperation.py
--- a/DataPreperation.py	(revision ed955f4271dd7db2f830f3c983e506164ec9676e)
+++ b/DataPreperation.py	(date 1644527592716)
@@ -91,7 +91,7 @@
                         TECHNIQUE_DICT[technique].append(row)
 
 
-path = 'C:\\Users\\ADMIN\\Documents\\AttackGraphs\\Attack-GraphsProject\\MulVAL to MITRE-for IR Manager.xlsx'
+path = 'C:\\Users\\yael6\\Downloads\\MulVAL to MITRE-for IR Manager.xlsx'
 dfMulVAl = pd.read_excel(path)
 # create_ir_dict(dfMulVAl)
 # create_explanation_keyword_dict(dfMulVAl)
